<!doctype html><html lang=en><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Elegant Functional Programming Application Architecture</title><meta name=author content="Yann Esposito"><meta name=description content="An elegant and working code architecture"><meta name=keywords content="blog static"><meta name=theme-color content="#d84100"><link rel=stylesheet href=/css/y.css><link rel=alternate type=application/rss+xml href=/rss.xml><link rel=icon href=/favicon.ico><div class=main><div id=logo><a href=/><svg width="5em" viewBox="0 0 64 64"><circle cx="32" cy="32" r="30" stroke="#a3aec2" stroke-width="1" fill="#2e3440"/><circle cx="32" cy="32" r="12" stroke="#800" stroke-width="1" fill="#c20"/><circle cx="32" cy="32" r="5" stroke-width="1" stroke="#f60" fill="#fa0"/><ellipse cx="32" cy="14" rx="14" ry="8" stroke-width="0" fill="#fff"/></svg></a></div><div id=preamble class=status><div class=content><h1>Elegant Functional Programming Application Architecture</h1><div class=meta><span class=yyydate>[2021-09-26 Sun]</span> on
<a href=https://her.esy.fun><span class=author>Yann Esposito</span>'s blog</a></div><div class=abstract>An elegant and working code architecture</div></div></div><div id=content><p>In this article I will expose you about how to architect your application using function programming paradigm.<p>It is not tied to any programming language. The principles in this article could probably be used by most programming languages.<h1 id=pre>Pre</h1><p>First note that many <em>functional programming languages</em> are not functional. They all provide holes in order to trick the system to be faster. Also for internal use, some advanced feature might be provided.<ol><li>Type-classes ; this is not something I consider belongs to functional programming.<li>Clojure Protocols, <code>defmulti</code> ; are not something I would consider belongs to functional programming.</ol><p>And many other languages features. Let be radical functional programmer.<p>Radical, means going back to the roots.<p>So here we go. Functional programming is about manipulating functions with the meaning of <strong>mathematical functions</strong> not what most programming language call functions. A "function" in C, Clojure, Python, Java, Javascript is <strong>not</strong> a function in the functional programming sense. OTOH in Haskell it is <em>often</em> a real function, but not always.<p>So a mathematical function is something that takes a bunch of parameters and return a value (or not, we should allow partial functions unfortunately). And if you provide the same parameter twice the result will always be the same. Also, it should not have any side effect, for example, it should log, emit sounds, … nothing.<p>Whoa whoa… Give me a minute here. Why would we want to … do nothing at all? Isn't writing an application about doing things? Yes, it is.<p>Let just say, that, you generally, don't need more than plunging a pure function graph into a context where an interpreter will be able to use and this big pile of pure functions will be used to have side effect. A big ball of pure functions are reproducible, easy to test, easy to analyze and reason about. Easy to expose business logic out of technical detail to access data, etc…<p>So I will provide a system as radical, and simple as possible that will have a lot of good properties that advanced functional programming methods (like Monad, Monads transformers, Free Monads, Effect systems) are trying to achieve.<h1 id=the-architecture>The Architecture</h1><p>The main architecture is based on the <em>Service</em> paradigm. A service will be a sub-application living at runtime, it will depends on other services, and have an internal state.<p>So in the end your application should look like an acyclic graph of services.<p>Every service has an init phase, then a living phase, then a stop phase. Every service declare a set of methods to be used and every service will keep an internal implicit state.<p>Even if this look a lot like Object oriented programming. It is in fact a quite radical functional programming architecture.<div class=sourceCode id=cb1><pre class="sourceCode clojure"><code class="sourceCode clojure"><span id=cb1-1><a href=#cb1-1 aria-hidden=true></a>(<span class=bu>def</span><span class=fu> Interface</span></span>
<span id=cb1-2><a href=#cb1-2 aria-hidden=true></a>  (function<span class=dv>-1</span> [arg<span class=dv>-1</span> arg<span class=dv>-2</span>] <span class=st>&quot;a function&quot;</span>))</span>
<span id=cb1-3><a href=#cb1-3 aria-hidden=true></a></span>
<span id=cb1-4><a href=#cb1-4 aria-hidden=true></a><span class=co>;; Main implementation of /my-service/</span></span>
<span id=cb1-5><a href=#cb1-5 aria-hidden=true></a>(defservice my-service</span>
<span id=cb1-6><a href=#cb1-6 aria-hidden=true></a>  Interface</span>
<span id=cb1-7><a href=#cb1-7 aria-hidden=true></a>  [sub-service<span class=dv>-1</span></span>
<span id=cb1-8><a href=#cb1-8 aria-hidden=true></a>   sub-service<span class=dv>-2</span></span>
<span id=cb1-9><a href=#cb1-9 aria-hidden=true></a>   ,,,</span>
<span id=cb1-10><a href=#cb1-10 aria-hidden=true></a>   sub-service-n]</span>
<span id=cb1-11><a href=#cb1-11 aria-hidden=true></a>  (init [initial-ctx]</span>
<span id=cb1-12><a href=#cb1-12 aria-hidden=true></a>        (<span class=kw>let</span> [service-state</span>
<span id=cb1-13><a href=#cb1-13 aria-hidden=true></a>              (core/init {<span class=at>:sub-service-1</span> sub-service<span class=dv>-1</span> ,,,})]</span>
<span id=cb1-14><a href=#cb1-14 aria-hidden=true></a>          (<span class=kw>into</span> initial-ctx service-state)))</span>
<span id=cb1-15><a href=#cb1-15 aria-hidden=true></a></span>
<span id=cb1-16><a href=#cb1-16 aria-hidden=true></a>  (function<span class=dv>-1</span> [ctx arg<span class=dv>-1</span> arg<span class=dv>-2</span>]</span>
<span id=cb1-17><a href=#cb1-17 aria-hidden=true></a>              (core/function<span class=dv>-1</span> ctx arg<span class=dv>-1</span> arg<span class=dv>-2</span>)))</span>
<span id=cb1-18><a href=#cb1-18 aria-hidden=true></a></span>
<span id=cb1-19><a href=#cb1-19 aria-hidden=true></a><span class=co>;; A test implementation of /my-service/</span></span>
<span id=cb1-20><a href=#cb1-20 aria-hidden=true></a>(defservice my-test-service</span>
<span id=cb1-21><a href=#cb1-21 aria-hidden=true></a>  Interface</span>
<span id=cb1-22><a href=#cb1-22 aria-hidden=true></a>  [sub-service<span class=dv>-1</span></span>
<span id=cb1-23><a href=#cb1-23 aria-hidden=true></a>   sub-service<span class=dv>-2</span></span>
<span id=cb1-24><a href=#cb1-24 aria-hidden=true></a>   ,,,</span>
<span id=cb1-25><a href=#cb1-25 aria-hidden=true></a>   sub-service-n]</span>
<span id=cb1-26><a href=#cb1-26 aria-hidden=true></a>  (init [initial-ctx]</span>
<span id=cb1-27><a href=#cb1-27 aria-hidden=true></a>        (<span class=kw>let</span> [service-state</span>
<span id=cb1-28><a href=#cb1-28 aria-hidden=true></a>              (test/init {<span class=at>:sub-service-1</span> sub-service<span class=dv>-1</span> ,,,})]</span>
<span id=cb1-29><a href=#cb1-29 aria-hidden=true></a>          (<span class=kw>into</span> initial-ctx service-state)))</span>
<span id=cb1-30><a href=#cb1-30 aria-hidden=true></a></span>
<span id=cb1-31><a href=#cb1-31 aria-hidden=true></a>  (function<span class=dv>-1</span> [ctx arg<span class=dv>-1</span> arg<span class=dv>-2</span>]</span>
<span id=cb1-32><a href=#cb1-32 aria-hidden=true></a>              (test/function<span class=dv>-1</span> ctx arg<span class=dv>-1</span> arg<span class=dv>-2</span>)))</span>
<span id=cb1-33><a href=#cb1-33 aria-hidden=true></a></span></code></pre></div></div><div id=postamble class=status><div class=content><nav><a href=/index.html>Home</a> |
<a href=/slides.html>Slides</a> |
<a href=/about-me.html>About</a>
<span class=details>(<a href=https://gitea.esy.fun/yogsototh>code</a>
<a href=https://espial.esy.fun/u:yogsototh>bookmarks</a>
<a href=https://espial.esy.fun/u:yogsototh/notes>notes</a>)</span> |
<a href=#logo>↑ Top ↑</a></nav></div></div></div>