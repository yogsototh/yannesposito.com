<!doctype html><html lang=en><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Catalina iTerm Theme switch</title><meta name=author content="Yann Esposito"><meta name=description content="Change the profile of iTerm in sync with macOS preferences."><meta name=keywords content="self-hosting chat irc"><link rel=stylesheet href=/css/y.css><link rel=alternate type=application/rss+xml href=/rss.xml><link rel=icon href=/favicon.ico><div id=labels><div class=ak><span id=logo><a href=/><svg width="5em" viewBox="0 0 64 64"><circle cx="32" cy="32" r="30" stroke="var(--b2)" stroke-width="2" fill="var(--b03)"/><circle cx="32" cy="32" r="12" stroke="var(--r)" stroke-width="2" fill="var(--o)"/><circle cx="32" cy="32" r="6" stroke-width="0" fill="var(--y)"/><ellipse cx="32" cy="14" rx="14" ry="8" stroke-width="0" fill="var(--b3)"/></svg></a></span></div></div><div class=cb><div id=preamble class=ap><div class=ak><h1>Catalina iTerm Theme switch</h1><div class=bz><span class=yyydate>[2019-11-10 Sun]</span> on
<a href=https://her.esy.fun><span class=bb>Yann Esposito</span>'s blog</a></div><div class=ab>Change the profile of iTerm in sync with macOS preferences.</div></div></div><div id=content><div class=bh><p>How to have dark/light profile selected when opening a new iTerm.</div><h1 id=the-script>The script</h1><p>For the script to work you need to have two iTerm profiles, one named <code class=v>Dark</code> and the other one <code class=v>Light</code>. Just go to <code class=v>Preferences</code> then <code class=v>Profiles</code> then <code class=v>Duplicate profile</code>.<p>I use <code class=v>fish</code> but you can easily adapt that in your <code class=v>.bashrc</code>, <code class=v>.bash_profile</code> etc…<p>Here is what I have in my <code class=v>~/.config/fish/config.fish</code>:<pre class=ce><code>function setItermProfile
    echo -ne &quot;\033]50;SetProfile=$argv\a&quot;
end

function sync_appearance

    set -x MacOSThemeAutoSwitch \
        (defaults read -g AppleInterfaceStyleSwitchesAutomatically 2&gt;/dev/null)
    test -z $MacOSThemeAutoSwitch; and set -x MacOSThemeAutoSwitch 0

    set -x MacOSTheme (defaults read -g AppleInterfaceStyle 2&gt;/dev/null)
    test -z $MacOSTheme; and set -x MacOSTheme &#39;nil&#39;

    if test -n $ITERM_PROFILE # check if we are using iTerm2
        switch $MacOSThemeAutoSwitch
            case 1 # autoswitch on
                switch $MacOSTheme
                    case &#39;nil&#39;
                        setItermProfile Light
                    case &#39;*&#39;
                        setItermProfile Dark
                end
            case 0 # autoswitch off
                switch $MacOSTheme
                    case &#39;Dark&#39;
                        setItermProfile Dark
                    case &#39;Light&#39;
                        setItermProfile Light
                    case &#39;nil&#39;
                        setItermProfile Light
                end
        end
    end
end

if status --is-login
    if status --is-interactive
        sync_appearance
    end
end
</code></pre><p>If the appearance change, you can call <code class=v>sync_appearance</code> function in your shell to sync with the OS dark/light appearance.</div><div id=postamble class=ap><div class=ak><nav><a href=/index.html>Home</a> |
<a href=/slides.html>Slides</a> |
<a href=/about-me.html>About</a>
<span class=ai>(<a href=https://gitea.esy.fun/yogsototh>code</a>
<a href=https://espial.esy.fun/u:yogsototh>bookmarks</a>
<a href=https://espial.esy.fun/u:yogsototh/notes>notes</a>)</span> |
<a href=#preamble>↑ Top ↑</a></nav></div></div></div>